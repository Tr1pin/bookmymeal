<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario de Producto</title>
</head>
<body>
  <h1>Crear Producto</h1>
  <form id="productoForm" method="post" enctype="multipart/form-data">
    <label for="nombre">Nombre:</label>
    <input type="text" name="nombre" id="nombre" required><br><br>

    <label for="descripcion">Descripción:</label>
    <textarea name="descripcion" id="descripcion" required></textarea><br><br>

    <label for="precio">Precio:</label>
    <input type="number" name="precio" id="precio" step="0.01" required><br><br>

    <label for="disponible">Disponible:</label>
    <input type="checkbox" name="disponible" id="disponible"><br><br>

    <label for="imagen">Imagen:</label>
    <input type="file" name="imagen" id="imagen" required><br><br>

    <button type="submit">Enviar</button>
  </form>

  <script>
   document.getElementById('productoForm').addEventListener('submit', formulario);

async function formulario(e) {
      e.preventDefault();
      console.log("En la función");

      const form = e.target;
      const formData = new FormData();

      // Agregar campos de texto
      formData.append("nombre", form.elements['nombre'].value);
      formData.append("descripcion", form.elements['descripcion'].value);
      formData.append("precio", form.elements['precio'].value);
      formData.append("disponible", form.elements['disponible'].checked ? 'true' : 'false');

      // Agregar archivos
      const archivos = form.elements['imagen'].files;
      for (let i = 0; i < archivos.length; i++) {
        formData.append("imagen", archivos[i]);
      }


      // Mostrar contenido del FormData (solo para depuración)
      for (let pair of formData.entries()) {
        console.log(`${pair[0]}: ${pair[1]}`);
      }
  alert('Producto enviado correctamente');
      // Enviar al servidor
      const response = await 
      fetch('http://localhost:3001/productos/', {
        method: 'POST',
        body: formData,
      })
        .then(response => {
          console.log(response.json());
          console.log(response);
        });
      alert('Producto enviado correctamente');
    }
  </script>
</body>
</html>
